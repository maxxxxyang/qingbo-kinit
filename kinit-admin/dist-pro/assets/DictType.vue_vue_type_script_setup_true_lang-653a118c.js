import{f as e,h as a,i as t,j as l,k as s}from"./dict-b26f862b.js";import{u as o,_ as n}from"./Table.vue_vue_type_script_lang-5256bd69.js";import{e as i,G as u,M as r,x as d,ak as p,a3 as c,N as _,r as m,o as f,j as v,m as y,k as g,ao as w,z as h,aD as b,P as k}from"./index-9da7d198.js";import{E as j}from"./el-button-8f21380c.js";import{E as C}from"./el-switch-7720805d.js";import{a as D,E as x}from"./el-col-d9273186.js";import{_ as R}from"./Search.vue_vue_type_script_setup_true_lang-a57e37eb.js";import{_ as z}from"./ContentWrap.vue_vue_type_script_setup_true_lang-9c7e578a.js";import{_ as P}from"./Write.vue_vue_type_script_setup_true_lang-4fc8089e.js";import{_ as I}from"./Dialog.vue_vue_type_style_index_0_lang-fcbfdb5d.js";const S=i({__name:"DictType",emits:["updateDictTypeId"],setup(i,{emit:S}){const{t:T}=u(),{tableRegister:E,tableState:U,tableMethods:L}=o({fetchDataApi:async()=>{const{pageSize:e,currentPage:t}=U,l=await a({page:g(t),limit:g(e),...g(F)});return{list:l.data||[],total:l.count||0}},fetchDelApi:async e=>{const a=await t(e);return 200===a.code&&await ne(),200===a.code}}),{dataList:A,loading:V,total:M,pageSize:N,currentPage:W}=U,{getList:G,delList:K,getElTableExpose:$}=L,q=r([{field:"id",label:"字典编号",width:"80px",show:!1,disabled:!1},{field:"dict_name",label:"字典名称",show:!0,disabled:!0},{field:"dict_type",label:"字典类型",show:!0,disabled:!0,slots:{default:e=>{const a=e.row;return d(c,null,[d("span",{onClick:()=>(async e=>{const{copy:a}=b();return await a(e),k.success("复制成功")})(a.dict_type)},[d(p,{icon:"material-symbols:content-copy-rounded",class:"cursor-pointer"},null)]),d("span",null,[a.dict_type])])}}},{field:"disabled",label:"是否禁用",width:"120px",show:!0,slots:{default:e=>{const a=e.row;return d(c,null,[d(C,{value:!a.disabled,disabled:!0},null)])}}},{field:"remark",label:"备注",show:!1},{field:"create_datetime",label:"创建时间",show:!1},{field:"action",width:"120px",label:"操作",show:!0,slots:{default:e=>{const a=e.row;return d(c,null,[d(j,{type:"primary",link:!0,size:"small",onClick:()=>te(a)},{default:()=>[_("编辑")]}),d(j,{type:"danger",loading:J.value,link:!0,size:"small",onClick:()=>O(a)},{default:()=>[_("删除")]})])}}}]),B=r([{field:"dict_name",label:"字典名称",colProps:{span:24},component:"Input",componentProps:{clearable:!1}},{field:"dict_type",label:"字典类型",colProps:{span:24},component:"Input",componentProps:{clearable:!1}}]),F=m({}),H=e=>{W.value=1,F.value=e,G()},J=m(!1),O=async e=>{J.value=!0,await K(!0,[e.id]).finally((()=>{J.value=!1}))},Q=m(!1),X=m(""),Y=m(),Z=m(""),ee=m(),ae=m(!1),te=async a=>{const t=await e(a.id);t&&(X.value="编辑字典类型",Z.value="edit",Y.value=t.data,Q.value=!0)},le=()=>{X.value="新增字典类型",Z.value="add",Y.value=void 0,Q.value=!0},se=async()=>{const e=g(ee),a=await(null==e?void 0:e.submit());if(a){ae.value=!0;try{const e=m({});"add"===Z.value?(e.value=await l(a),e.value&&(Q.value=!1,G())):"edit"===Z.value&&(e.value=await s(a),e.value&&(Q.value=!1,G()))}finally{ae.value=!1}}},oe=async e=>{S("updateDictTypeId",e.id)},ne=async()=>{const e=await $();null==e||e.setCurrentRow(null),S("updateDictTypeId",null)};return(e,a)=>(f(),v(c,null,[d(g(z),null,{default:y((()=>[d(g(R),{schema:B,onReset:H,onSearch:H},null,8,["schema"]),d(g(n),{"current-page":g(W),"onUpdate:currentPage":a[0]||(a[0]=e=>w(W)?W.value=e:null),"page-size":g(N),"onUpdate:pageSize":a[1]||(a[1]=e=>w(N)?N.value=e:null),showAction:"",activeUID:"type",columns:q,"default-expand-all":"",highlightCurrentRow:!0,"node-key":"id",data:g(A),loading:g(V),pagination:{total:g(M)},onRegister:g(E),onCurrentChange:oe,onRefresh:g(G)},{toolbar:y((()=>[d(g(D),{gutter:10},{default:y((()=>[d(g(x),{span:1.5},{default:y((()=>[d(g(j),{type:"primary",onClick:le},{default:y((()=>[_("新增字典类型")])),_:1})])),_:1}),d(g(x),{span:1.5},{default:y((()=>[d(g(j),{type:"danger",onClick:ne},{default:y((()=>[_("清除选择")])),_:1})])),_:1})])),_:1})])),_:1},8,["current-page","page-size","columns","data","loading","pagination","onRegister","onRefresh"])])),_:1}),d(g(I),{modelValue:Q.value,"onUpdate:modelValue":a[3]||(a[3]=e=>Q.value=e),title:X.value,height:650},{footer:y((()=>[d(g(j),{type:"primary",loading:ae.value,onClick:se},{default:y((()=>[_(h(g(T)("exampleDemo.save")),1)])),_:1},8,["loading"]),d(g(j),{onClick:a[2]||(a[2]=e=>Q.value=!1)},{default:y((()=>[_(h(g(T)("dialogDemo.close")),1)])),_:1})])),default:y((()=>[d(P,{ref_key:"writeRef",ref:ee,"current-row":Y.value},null,8,["current-row"])])),_:1},8,["modelValue","title"])],64))}});export{S as _};
