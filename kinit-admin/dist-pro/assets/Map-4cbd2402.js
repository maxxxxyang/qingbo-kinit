import{af as a,ag as e,Y as n,e as o,ah as i,o as t,j as s,ai as p,r as l,J as r}from"./index-9da7d198.js";var c={exports:{}};const d=e(c.exports=function(){function a(a){var o=[];return a.AMapUI&&o.push(e(a.AMapUI)),a.Loca&&o.push(n(a.Loca)),Promise.all(o)}function e(a){return new Promise((function(e,n){var i=[];if(a.plugins)for(var l=0;l<a.plugins.length;l+=1)-1==t.AMapUI.plugins.indexOf(a.plugins[l])&&i.push(a.plugins[l]);if(s.AMapUI===o.failed)n("前次请求 AMapUI 失败");else if(s.AMapUI===o.notload){s.AMapUI=o.loading,t.AMapUI.version=a.version||t.AMapUI.version,l=t.AMapUI.version;var r=document.body||document.head,c=document.createElement("script");c.type="text/javascript",c.src="https://webapi.amap.com/ui/"+l+"/main.js",c.onerror=function(a){s.AMapUI=o.failed,n("请求 AMapUI 失败")},c.onload=function(){if(s.AMapUI=o.loaded,i.length)window.AMapUI.loadUI(i,(function(){for(var a=0,n=i.length;a<n;a++){var o=i[a].split("/").slice(-1)[0];window.AMapUI[o]=arguments[a]}for(e();p.AMapUI.length;)p.AMapUI.splice(0,1)[0]()}));else for(e();p.AMapUI.length;)p.AMapUI.splice(0,1)[0]()},r.appendChild(c)}else s.AMapUI===o.loaded?a.version&&a.version!==t.AMapUI.version?n("不允许多个版本 AMapUI 混用"):i.length?window.AMapUI.loadUI(i,(function(){for(var a=0,n=i.length;a<n;a++){var o=i[a].split("/").slice(-1)[0];window.AMapUI[o]=arguments[a]}e()})):e():a.version&&a.version!==t.AMapUI.version?n("不允许多个版本 AMapUI 混用"):p.AMapUI.push((function(a){a?n(a):i.length?window.AMapUI.loadUI(i,(function(){for(var a=0,n=i.length;a<n;a++){var o=i[a].split("/").slice(-1)[0];window.AMapUI[o]=arguments[a]}e()})):e()}))}))}function n(a){return new Promise((function(e,n){if(s.Loca===o.failed)n("前次请求 Loca 失败");else if(s.Loca===o.notload){s.Loca=o.loading,t.Loca.version=a.version||t.Loca.version;var i=t.Loca.version,l=t.AMap.version.startsWith("2"),r=i.startsWith("2");if(l&&!r||!l&&r)n("JSAPI 与 Loca 版本不对应！！");else{l=t.key,r=document.body||document.head;var c=document.createElement("script");c.type="text/javascript",c.src="https://webapi.amap.com/loca?v="+i+"&key="+l,c.onerror=function(a){s.Loca=o.failed,n("请求 AMapUI 失败")},c.onload=function(){for(s.Loca=o.loaded,e();p.Loca.length;)p.Loca.splice(0,1)[0]()},r.appendChild(c)}}else s.Loca===o.loaded?a.version&&a.version!==t.Loca.version?n("不允许多个版本 Loca 混用"):e():a.version&&a.version!==t.Loca.version?n("不允许多个版本 Loca 混用"):p.Loca.push((function(a){a?n(a):n()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var o,i;(i=o||(o={})).notload="notload",i.loading="loading",i.loaded="loaded",i.failed="failed";var t={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},p={AMap:[],AMapUI:[],Loca:[]},l=[],r=function(a){"function"==typeof a&&(s.AMap===o.loaded?a(window.AMap):l.push(a))};return{load:function(e){return new Promise((function(n,i){if(s.AMap==o.failed)i("");else if(s.AMap==o.notload){var p=e.key,c=e.version,d=e.plugins;p?(window.AMap&&"lbs.amap.com"!==location.host&&i("禁止多种API加载方式混用"),t.key=p,t.AMap.version=c||t.AMap.version,t.AMap.plugins=d||t.AMap.plugins,s.AMap=o.loading,c=document.body||document.head,window.___onAPILoaded=function(t){if(delete window.___onAPILoaded,t)s.AMap=o.failed,i(t);else for(s.AMap=o.loaded,a(e).then((function(){n(window.AMap)})).catch(i);l.length;)l.splice(0,1)[0]()},(d=document.createElement("script")).type="text/javascript",d.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+t.AMap.version+"&key="+p+"&plugin="+t.AMap.plugins.join(","),d.onerror=function(a){s.AMap=o.failed,i(a)},c.appendChild(d)):i("请填写key")}else if(s.AMap==o.loaded)if(e.key&&e.key!==t.key)i("多个不一致的 key");else if(e.version&&e.version!==t.AMap.version)i("不允许多个版本 JSAPI 混用");else{if(p=[],e.plugins)for(c=0;c<e.plugins.length;c+=1)-1==t.AMap.plugins.indexOf(e.plugins[c])&&p.push(e.plugins[c]);p.length?window.AMap.plugin(p,(function(){a(e).then((function(){n(window.AMap)})).catch(i)})):a(e).then((function(){n(window.AMap)})).catch(i)}else if(e.key&&e.key!==t.key)i("多个不一致的 key");else if(e.version&&e.version!==t.AMap.version)i("不允许多个版本 JSAPI 混用");else{var u=[];if(e.plugins)for(c=0;c<e.plugins.length;c+=1)-1==t.AMap.plugins.indexOf(e.plugins[c])&&u.push(e.plugins[c]);r((function(){u.length?window.AMap.plugin(u,(function(){a(e).then((function(){n(window.AMap)})).catch(i)})):a(e).then((function(){n(window.AMap)})).catch(i)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,t={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},p={AMap:[],AMapUI:[],Loca:[]}}}}()),u={id:"map-container"},v=r(o({name:"DashboardMap",__name:"Map",setup(a){let e=i(),o=i();const r=async()=>{const a=new o.value.InfoWindow({offset:new o.value.Pixel(2,15),closeWhenClickMap:!0,isCustom:!0,anchor:"top-left"}),i=await n.get({url:"/vadmin/record/analysis/user/login/distribute"});if(i){const n=i.data.map((n=>{const i=n.center;let t=l();if(n.total>40){t.value=new o.value.Marker({position:i,offset:new o.value.Pixel(0,15)});var s=document.createElement("div");s.className="alarmDevice",t.value.setContent(s)}else t.value=new o.value.CircleMarker({center:i,radius:n.total>30?20:n.total/2,strokeColor:"#f05b72",strokeWeight:2,strokeOpacity:.5,fillColor:"#f05b72",fillOpacity:.5,zIndex:10,bubble:!0,cursor:"pointer",clickable:!0});return t.value.on("mouseover",(()=>{a.setContent(`<div class="description">\n              <div class="name-box">\n                <span class="point"></span>\n                <span class="name">${n.name}</span>\n              </div>\n              <span>${n.total}</span>\n            </div>`),a.open(e.value,i)})),t.value.on("mouseout",(()=>{a.close(e.value,i)})),t.value}));e.value.add(n)}};return(async()=>{const a=await p({tab_id:8});a&&d.load({key:a.data.map_key,version:"2.0",plugins:[""]}).then((async n=>{o.value=n,e.value=new n.Map("map-container",{pitch:a.data.map_pitch,terrain:!0,viewMode:a.data.map_view_mode,zoom:a.data.map_zoom,resizeEnable:!0,mapStyle:a.data.map_style,center:JSON.parse(a.data.map_center)}),await r()})).catch((a=>{}))})(),(a,e)=>(t(),s("div",u))}}),[["__scopeId","data-v-f3fb4ae5"]]);export{v as default};
