import{g as e,d as a,a as l,p as t}from"./menu-519ca870.js";import{u as s,_ as i}from"./Table.vue_vue_type_script_lang-5256bd69.js";import{e as o,G as r,r as u,M as n,x as d,ak as p,a3 as m,a8 as c,a6 as v,N as f,o as _,j,m as h,k as w,l as y,z as g,O as b}from"./index-9da7d198.js";import{E as x}from"./el-button-8f21380c.js";import{E as k}from"./el-switch-7720805d.js";import{a as C,E as R}from"./el-col-d9273186.js";import{_ as A}from"./ContentWrap.vue_vue_type_script_setup_true_lang-9c7e578a.js";import{_ as D}from"./Write.vue_vue_type_script_setup_true_lang-9d6b05c6.js";import{_ as P}from"./Dialog.vue_vue_type_style_index_0_lang-fcbfdb5d.js";import{u as z}from"./dict-b6f9162a.js";import{s as M}from"./dict-ab5a6743.js";import"./el-message-box-24354127.js";import"./el-input-26eda071.js";import"./event-5568c9d8.js";import"./use-form-item-8b7f5d34.js";import"./use-form-common-props-9d083c67.js";import"./index-cde97138.js";import"./isNil-1f22f7b0.js";import"./el-overlay-037540a2.js";import"./el-checkbox-group-b617b779.js";import"./vnode-ae242abb.js";import"./useForm-ecbcdb43.js";import"./el-tooltip-4ed993c7.js";import"./el-popper-2fae9050.js";import"./el-tag-aef2ce12.js";import"./index-13d6a136.js";import"./el-date-picker-f32b0b71.js";import"./debounce-778af7ed.js";import"./el-divider-fc00d058.js";import"./el-progress-69812d34.js";import"./style.css_vue_type_style_index_0_src_true_lang-0e7f3b44.js";import"./index-14d9f390.js";import"./strings-e2e316bd.js";import"./index-4dbb39b8.js";import"./el-table-column-102f47a6.js";import"./el-image-viewer-83790b35.js";import"./el-dropdown-item-c082162c.js";import"./refs-4f0941bf.js";/* empty css                   */import"./_Uint8Array-bbcc3a61.js";import"./el-card-5fa288fa.js";import"./useValidator-e352e7a8.js";import"./dict-b26f862b.js";const S=o({name:"AuthMenu",__name:"Menu",setup(o){const{t:S}=r(),{tableRegister:L,tableState:V,tableMethods:E}=s({fetchDataApi:async()=>{const{pageSize:a,currentPage:l}=V,t=await e({page:w(l),limit:w(a)});return{list:t.data||[],total:t.count||0}},fetchDelApi:async e=>200===(await a(e)).code}),{dataList:N,loading:O}=V,{getList:U,delList:W}=E;let q=u([]);(async()=>{const e=z(),a=await e.getDictObj(["sys_vadmin_menu_type"]);q.value=a.sys_vadmin_menu_type})();const B=n([{field:"title",label:"菜单名称",width:"200px",disabled:!0,show:!0},{field:"icon",label:"图标",width:"120px",show:!1,slots:{default:e=>{const a=e.row;return d(m,null,[a.icon?d(p,{icon:a.icon},null):""])}}},{field:"order",label:"排序",width:"120px",show:!0},{field:"menu_type",label:"菜单类型",width:"120px",show:!0,slots:{default:e=>{const a=e.row;return d(m,null,[d("span",null,[M(q.value,a.menu_type)])])}}},{field:"perms",label:"权限标识",width:"150px",show:!0},{field:"path",label:"路由地址",show:!0},{field:"component",label:"组件路径",show:!0},{field:"noCache",label:"页面缓存",width:"120px",show:!0,slots:{default:e=>{const a=e.row;return d(m,null,[d(k,{value:!a.noCache,disabled:!0},null)])}}},{field:"hidden",label:"显示状态",width:"120px",show:!0,slots:{default:e=>{const a=e.row;return d(m,null,[d(k,{value:!a.hidden,disabled:!0},null)])}}},{field:"disabled",label:"菜单状态",width:"120px",show:!0,slots:{default:e=>{const a=e.row;return d(m,null,[d(k,{value:!a.disabled,disabled:!0},null)])}}},{field:"action",width:"200px",label:"操作",show:!0,slots:{default:e=>{const a=e.row;return d(m,null,[c(d(x,{type:"primary",link:!0,size:"small",onClick:()=>X(a)},{default:()=>[f("编辑")]}),[[v("hasPermi"),["auth.menu.update"]]]),c(d(x,{type:"primary",link:!0,size:"small",onClick:()=>Z(a)},{default:()=>[f("添加子菜单")]}),[[v("hasPermi"),["auth.menu.create"]]]),c(d(x,{type:"danger",loading:F.value,link:!0,size:"small",onClick:()=>G(a)},{default:()=>[f("删除")]}),[[v("hasPermi"),["auth.menu.delete"]]])])}}}]),F=u(!1),G=async e=>{F.value=!0,await W(!0,[e.id]).finally((()=>{F.value=!1}))},H=u(!1),J=u(""),K=u(),Q=u(void 0),T=u(""),$=u(),I=u(!1),X=e=>{J.value="编辑",T.value="edit",K.value=e,H.value=!0},Y=()=>{J.value="新增",T.value="add",K.value=void 0,H.value=!0},Z=e=>{J.value="添加子菜单",T.value="addSon",Q.value=e.id,K.value=void 0,H.value=!0},ee=async()=>{const e=w($),a=await(null==e?void 0:e.submit());if(a){I.value=!0;try{const e=u({});"add"===T.value||"addSon"===T.value?(e.value=await l(a),e.value&&(Q.value=void 0,H.value=!1,U())):"edit"===T.value&&(e.value=await t(a),e.value&&(H.value=!1,U()))}finally{I.value=!1}}};return(e,a)=>{const l=v("hasPermi");return _(),j(m,null,[d(w(A),null,{default:h((()=>[d(w(i),{columns:B,showAction:"","default-expand-all":"","node-key":"id",data:w(N),loading:w(O),onRegister:w(L),onRefresh:w(U)},{toolbar:h((()=>[d(w(C),{gutter:10},{default:h((()=>[d(w(R),{span:1.5},{default:h((()=>[c((_(),y(w(x),{type:"primary",onClick:Y},{default:h((()=>[f("新增菜单")])),_:1})),[[l,["auth.menu.create"]]])])),_:1})])),_:1})])),_:1},8,["columns","data","loading","onRegister","onRefresh"])])),_:1}),d(w(P),{modelValue:H.value,"onUpdate:modelValue":a[1]||(a[1]=e=>H.value=e),title:J.value},{footer:h((()=>["detail"!==T.value?(_(),y(w(x),{key:0,type:"primary",loading:I.value,onClick:ee},{default:h((()=>[f(g(w(S)("exampleDemo.save")),1)])),_:1},8,["loading"])):b("",!0),d(w(x),{onClick:a[0]||(a[0]=e=>H.value=!1)},{default:h((()=>[f(g(w(S)("dialogDemo.close")),1)])),_:1})])),default:h((()=>[d(D,{ref_key:"writeRef",ref:$,"current-row":K.value,"parent-id":Q.value},null,8,["current-row","parent-id"])])),_:1},8,["modelValue","title"])],64)}}});export{S as default};
