import{u as s,F as e}from"./useForm-ecbcdb43.js";import{u as t}from"./useValidator-e352e7a8.js";import{e as o,K as r,v as a,A as i,L as l,f as p,M as d,r as n,w as m,o as c,j as u,y as j,x as g,k as v,m as f,N as w,l as _,O as h,P as x,Q as y,R as b,H as R,I as k,S as P,J as F}from"./index-9da7d198.js";import{E as I}from"./el-button-8f21380c.js";import{_ as q}from"./Footer.vue_vue_type_script_setup_true_lang-eea0286d.js";import"./el-col-d9273186.js";import"./el-tooltip-4ed993c7.js";import"./el-popper-2fae9050.js";import"./isNil-1f22f7b0.js";import"./index-cde97138.js";import"./use-form-common-props-9d083c67.js";import"./el-input-26eda071.js";import"./event-5568c9d8.js";import"./use-form-item-8b7f5d34.js";import"./el-tag-aef2ce12.js";import"./index-13d6a136.js";import"./el-checkbox-group-b617b779.js";import"./el-date-picker-f32b0b71.js";import"./debounce-778af7ed.js";import"./el-switch-7720805d.js";import"./el-divider-fc00d058.js";import"./el-progress-69812d34.js";import"./style.css_vue_type_style_index_0_src_true_lang-0e7f3b44.js";import"./index-14d9f390.js";import"./strings-e2e316bd.js";import"./index-4dbb39b8.js";const E={class:"main-container"},A={class:"form-container"},C=(s=>(R("data-v-5da04e25"),s=s(),k(),s))((()=>j("div",null,[j("h2",{class:"text-2xl font-bold text-center w-[100%]"},"第一次登录系统，需先重置密码")],-1))),M={class:"w-[100%]"},N={class:"footer-container"},S=F(o({__name:"Reset",setup(o){const{required:R}=t(),{setStorage:k}=P(),{addRoute:F,push:S,currentRoute:U}=r(),V=a(),D=i(),H=l(),J=p((()=>D.getFooter)),K=d([{field:"password",label:"新密码",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:"请输入新密码"}},{field:"password_two",label:"再次输入新密码",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:"请再次输入新密码"}}]),L={password:[R(),{min:8,max:16,message:"长度需为8-16个字符,请重新输入。",trigger:"blur"}],password_two:[R(),{min:8,max:16,message:"长度需为8-16个字符,请重新输入。",trigger:"blur"}]},{formRegister:O,formMethods:Q}=s(),{setValues:$,getFormData:z,getElFormExpose:B}=Q;$(V.getUser);const G=n(!1),T=n("");m((()=>U.value),(s=>{var e;T.value=null==(e=null==s?void 0:s.query)?void 0:e.redirect}),{immediate:!0});const W=async()=>{if(1===V.getUser.id)return x.warning("编辑账号为演示账号，无权限操作！");const s=await B();if(await(null==s?void 0:s.validate())){G.value=!0;const s=await z();try{await y(s)?X():G.value=!1}catch(e){G.value=!1}}},X=async()=>{const s=await b();if(s){const e=s.data||[];k("roleRouters",e),await H.generateRoutes(e).catch((()=>{})),H.getAddRouters.forEach((s=>{F(s)})),H.setIsAddRouters(!0),S({path:T.value||H.addRouters[0].path})}};return(s,t)=>(c(),u("div",E,[j("div",A,[C,g(v(e),{onRegister:v(O),schema:K,rules:L,"hide-required-asterisk":"",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid"},null,8,["onRegister","schema"]),j("div",M,[g(v(I),{loading:G.value,type:"primary",class:"w-[100%]",onClick:W},{default:f((()=>[w(" 重置密码 ")])),_:1},8,["loading"])])]),j("div",N,[J.value?(c(),_(v(q),{key:0})):h("",!0)])]))}}),[["__scopeId","data-v-5da04e25"]]);export{S as default};
