import{e,G as a,M as l,x as t,a3 as o,a8 as s,an as i,a6 as r,N as n,r as u,$ as p,o as d,j as m,m as c,k as _,ao as v,l as f,z as j}from"./index-9da7d198.js";import{g,a as b,d as h,b as y,p as w}from"./role-6b68436c.js";import{u as x,_ as k}from"./Table.vue_vue_type_script_lang-5256bd69.js";import{E as R}from"./el-button-8f21380c.js";import{E as P}from"./el-switch-7720805d.js";import{_ as z}from"./Search.vue_vue_type_script_setup_true_lang-a57e37eb.js";import{_ as S}from"./ContentWrap.vue_vue_type_script_setup_true_lang-9c7e578a.js";import{_ as C}from"./Write.vue_vue_type_script_setup_true_lang-63f193f9.js";import{_ as A}from"./Dialog.vue_vue_type_style_index_0_lang-fcbfdb5d.js";import"./el-message-box-24354127.js";import"./el-input-26eda071.js";import"./event-5568c9d8.js";import"./use-form-item-8b7f5d34.js";import"./use-form-common-props-9d083c67.js";import"./index-cde97138.js";import"./isNil-1f22f7b0.js";import"./el-overlay-037540a2.js";import"./el-checkbox-group-b617b779.js";import"./vnode-ae242abb.js";import"./useForm-ecbcdb43.js";import"./el-col-d9273186.js";import"./el-tooltip-4ed993c7.js";import"./el-popper-2fae9050.js";import"./el-tag-aef2ce12.js";import"./index-13d6a136.js";import"./el-date-picker-f32b0b71.js";import"./debounce-778af7ed.js";import"./el-divider-fc00d058.js";import"./el-progress-69812d34.js";import"./style.css_vue_type_style_index_0_src_true_lang-0e7f3b44.js";import"./index-14d9f390.js";import"./strings-e2e316bd.js";import"./index-4dbb39b8.js";import"./el-table-column-102f47a6.js";import"./el-image-viewer-83790b35.js";import"./el-dropdown-item-c082162c.js";import"./refs-4f0941bf.js";/* empty css                   */import"./_Uint8Array-bbcc3a61.js";import"./useIcon-6417bbff.js";import"./el-card-5fa288fa.js";import"./useValidator-e352e7a8.js";import"./menu-519ca870.js";import"./tree-74740d92.js";const D=e({name:"AuthRole",__name:"Role",setup(e){const{t:D}=a(),{tableRegister:U,tableState:V,tableMethods:E}=x({fetchDataApi:async()=>{const{pageSize:e,currentPage:a}=V,l=await b({page:_(a),limit:_(e),..._(F)});return{list:l.data||[],total:l.count||0}},fetchDelApi:async e=>200===(await h(e)).code}),{dataList:L,loading:I,total:N,pageSize:W,currentPage:M}=V,{getList:T,delList:$}=E,q=l([{field:"id",label:"角色编号",show:!0,disabled:!0},{field:"name",label:"角色名称",show:!0,disabled:!0},{field:"role_key",label:"权限字符",show:!0},{field:"order",label:"显示顺序",show:!0},{field:"disabled",label:"角色状态",show:!0,slots:{default:e=>{const a=e.row;return t(o,null,[t(P,{value:!a.disabled,disabled:!0},null)])}}},{field:"is_admin",label:"最高权限",show:!0,slots:{default:e=>{const a=e.row;return t(o,null,[t(P,{value:!a.is_admin,disabled:!0},null)])}}},{field:"create_datetime",label:"创建时间",show:!0},{field:"action",width:"150px",label:"操作",show:!0,slots:{default:e=>{const a=e.row;return t(o,null,[s(t(R,{type:"primary",link:!0,size:"small",onClick:()=>ee(a)},{default:()=>[n("编辑")]}),[[i,1!==a.id],[r("hasPermi"),["auth.role.update"]]]),s(t(R,{type:"danger",loading:H.value,link:!0,size:"small",onClick:()=>J(a)},{default:()=>[n("删除")]}),[[i,1!==a.id],[r("hasPermi"),["auth.role.delete"]]])])}}}]),B=l([{field:"name",label:"角色名称",component:"Input",componentProps:{clearable:!1,style:{width:"214px"}}},{field:"role_key",label:"权限字符",component:"Input",componentProps:{clearable:!1,style:{width:"214px"}}},{field:"disabled",label:"状态",component:"Select",componentProps:{style:{width:"214px"},options:[{label:"正常",value:!1},{label:"停用",value:!0}]}}]),F=u({}),G=e=>{M.value=1,F.value=e,T()},H=u(!1),J=async e=>{H.value=!0,await $(!0,[e.id]).finally((()=>{H.value=!1}))},K=u(!1),O=u(""),Q=u(),X=u(""),Y=u(),Z=u(!1),ee=async e=>{const a=await g(e.id);a&&(O.value="编辑",X.value="edit",Q.value=a.data,K.value=!0)},ae=()=>{O.value="新增",X.value="add",Q.value=void 0,K.value=!0},le=async()=>{const e=_(Y),a=await(null==e?void 0:e.submit());if(a){Z.value=!0;try{const e=u({});"add"===X.value?(e.value=await y(a),e.value&&(K.value=!1,T())):"edit"===X.value&&(e.value=await w(a),e.value&&(K.value=!1,T()))}finally{Z.value=!1}}};return(e,a)=>{const l=p("ElCol"),i=p("ElRow"),u=r("hasPermi");return d(),m(o,null,[t(_(S),null,{default:c((()=>[t(_(z),{schema:B,onReset:G,onSearch:G},null,8,["schema"]),t(_(k),{"current-page":_(M),"onUpdate:currentPage":a[0]||(a[0]=e=>v(M)?M.value=e:null),"page-size":_(W),"onUpdate:pageSize":a[1]||(a[1]=e=>v(W)?W.value=e:null),showAction:"",columns:q,"default-expand-all":"","node-key":"id",data:_(L),loading:_(I),pagination:{total:_(N)},onRegister:_(U),onRefresh:_(T)},{toolbar:c((()=>[t(i,{gutter:10},{default:c((()=>[t(l,{span:1.5},{default:c((()=>[s((d(),f(_(R),{type:"primary",onClick:ae},{default:c((()=>[n("新增角色")])),_:1})),[[u,["auth.role.create"]]])])),_:1})])),_:1})])),_:1},8,["current-page","page-size","columns","data","loading","pagination","onRegister","onRefresh"])])),_:1}),t(_(A),{modelValue:K.value,"onUpdate:modelValue":a[3]||(a[3]=e=>K.value=e),title:O.value,height:650},{footer:c((()=>[t(_(R),{type:"primary",loading:Z.value,onClick:le},{default:c((()=>[n(j(_(D)("exampleDemo.save")),1)])),_:1},8,["loading"]),t(_(R),{onClick:a[2]||(a[2]=e=>K.value=!1)},{default:c((()=>[n(j(_(D)("dialogDemo.close")),1)])),_:1})])),default:c((()=>[t(C,{ref_key:"writeRef",ref:Y,"current-row":Q.value},null,8,["current-row"])])),_:1},8,["modelValue","title"])],64)}}});export{D as default};
