import{u as e,_ as t}from"./Table.vue_vue_type_script_lang-5256bd69.js";import{e as s,G as a,K as l,r as o,M as i,x as r,a3 as p,N as n,o as m,j as u,m as d,k as c,ao as _,z as j,l as g,O as f}from"./index-9da7d198.js";import{E as v}from"./el-button-8f21380c.js";import{_ as b}from"./Search.vue_vue_type_script_setup_true_lang-a57e37eb.js";import{_ as h}from"./ContentWrap.vue_vue_type_script_setup_true_lang-9c7e578a.js";import{_ as w}from"./Detail.vue_vue_type_script_setup_true_lang-d7ef4a98.js";import{_ as x}from"./Dialog.vue_vue_type_style_index_0_lang-fcbfdb5d.js";import{s as y}from"./dict-ab5a6743.js";import{u as k}from"./dict-b6f9162a.js";import{g as R}from"./task-e1beb0af.js";import"./el-message-box-24354127.js";import"./el-input-26eda071.js";import"./event-5568c9d8.js";import"./use-form-item-8b7f5d34.js";import"./use-form-common-props-9d083c67.js";import"./index-cde97138.js";import"./isNil-1f22f7b0.js";import"./el-overlay-037540a2.js";import"./el-checkbox-group-b617b779.js";import"./vnode-ae242abb.js";import"./useForm-ecbcdb43.js";import"./el-col-d9273186.js";import"./el-tooltip-4ed993c7.js";import"./el-popper-2fae9050.js";import"./el-tag-aef2ce12.js";import"./index-13d6a136.js";import"./el-date-picker-f32b0b71.js";import"./debounce-778af7ed.js";import"./el-switch-7720805d.js";import"./el-divider-fc00d058.js";import"./el-progress-69812d34.js";import"./style.css_vue_type_style_index_0_src_true_lang-0e7f3b44.js";import"./index-14d9f390.js";import"./strings-e2e316bd.js";import"./index-4dbb39b8.js";import"./el-table-column-102f47a6.js";import"./el-image-viewer-83790b35.js";import"./el-dropdown-item-c082162c.js";import"./refs-4f0941bf.js";/* empty css                   */import"./_Uint8Array-bbcc3a61.js";import"./useIcon-6417bbff.js";import"./el-card-5fa288fa.js";import"./Descriptions-fb3623c2.js";import"./el-descriptions-item-be87a779.js";/* empty css              */import"./dict-b26f862b.js";const z=s({name:"SystemRecordTask",__name:"Task",setup(s){const{t:z}=a(),{currentRoute:S}=l(),D=S.value.query.job_id,P=o([]);(async()=>{const e=k(),t=await e.getDictObj(["vadmin_system_task_exec_strategy"]);P.value=t.vadmin_system_task_exec_strategy})();const{tableRegister:U,tableState:A,tableMethods:C}=e({immediate:!1,fetchDataApi:async()=>{const{pageSize:e,currentPage:t}=A,s=await R({page:c(t),limit:c(e),...c(M)});return{list:s.data||[],total:s.count||0}}}),{dataList:I,loading:L,total:N,pageSize:O,currentPage:T}=A,{getList:V}=C,q=i([{field:"job_id",label:"任务编号",show:!0,disabled:!0,width:"240px"},{field:"name",label:"任务名称",show:!0,disabled:!0},{field:"group",label:"任务分组",show:!0,span:2},{field:"job_class",label:"调用目标",show:!0},{field:"exec_strategy",label:"执行策略",show:!0,slots:{default:e=>{const t=e.row;return r(p,null,[r("div",null,[y(P.value,t.exec_strategy)])])}}},{field:"expression",label:"表达式",show:!0,span:24},{field:"start_time",label:"开始执行时间",show:!1,width:"200px"},{field:"end_time",label:"执行完成时间",width:"200px",show:!0},{field:"process_time",label:"耗时(秒)",width:"110px",show:!0},{field:"retval",label:"任务返回值",show:!0},{field:"exception",label:"异常信息",show:!1,span:24},{field:"traceback",label:"堆栈跟踪",show:!1,width:"100px"},{field:"action",width:"100px",label:"操作",show:!0,disabled:!0,slots:{default:e=>{const t=e.row;return r(p,null,[r(v,{type:"primary",link:!0,size:"small",onClick:()=>Q(t)},{default:()=>[n("详情")]})])}}}]),K=i([{field:"job_id",label:"任务编号",component:"Input",componentProps:{clearable:!0,style:{width:"240px"}},value:D},{field:"name",label:"任务名称",component:"Input",componentProps:{clearable:!0}}]),M=o({}),B=e=>{T.value=1,M.value=e,V()},E=o(!1),F=o(""),G=o(),H=o(""),Q=e=>{F.value=z("exampleDemo.detail"),H.value="detail",G.value=e,E.value=!0};return D?(M.value={job_id:D},V()):V(),(e,s)=>(m(),u(p,null,[r(c(h),null,{default:d((()=>[r(c(b),{schema:K,onReset:B,onSearch:B},null,8,["schema"]),r(c(t),{"current-page":c(T),"onUpdate:currentPage":s[0]||(s[0]=e=>_(T)?T.value=e:null),"page-size":c(O),"onUpdate:pageSize":s[1]||(s[1]=e=>_(O)?O.value=e:null),showAction:"",columns:q,"node-key":"id",data:c(I),loading:c(L),pagination:{total:c(N)},onRegister:c(U),onRefresh:c(V)},null,8,["current-page","page-size","columns","data","loading","pagination","onRegister","onRefresh"])])),_:1}),r(c(x),{modelValue:E.value,"onUpdate:modelValue":s[3]||(s[3]=e=>E.value=e),title:F.value,width:"800px"},{footer:d((()=>[r(c(v),{onClick:s[2]||(s[2]=e=>E.value=!1)},{default:d((()=>[n(j(c(z)("dialogDemo.close")),1)])),_:1})])),default:d((()=>["detail"===H.value?(m(),g(w,{key:0,"current-row":G.value},null,8,["current-row"])):f("",!0)])),_:1},8,["modelValue","title"])],64))}});export{z as default};
