import{u as e,F as t}from"./useForm-ecbcdb43.js";import{u as o}from"./useValidator-e352e7a8.js";import{u as s}from"./dict-b6f9162a.js";import{e as a}from"./task-e1beb0af.js";import{e as r,M as l,w as p,o as n,l as m,k as i}from"./index-9da7d198.js";const c=r({__name:"Write",props:{currentRow:{type:Object,default:()=>null}},setup(r,{expose:c}){const d=r,{required:u}=o(),f=l([{field:"name",label:"任务名称",component:"Input",colProps:{span:12},componentProps:{style:{width:"100%"}},formItemProps:{rules:[u()]}},{field:"group",label:"任务分组",colProps:{span:12},component:"Select",componentProps:{style:{width:"100%"},allowCreate:!0,filterable:!0,defaultFirstOption:!0,placeholder:"请选择任务分组，支持直接输入添加"},optionApi:async()=>(await a()).data},{field:"job_class",label:"调用目标",component:"Input",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:'调用示例：test.main.Test("kinit", 1314, True)；参数仅支持字符串，整数，浮点数，布尔类型。'},formItemProps:{rules:[u()]}},{field:"exec_strategy",label:"执行策略",colProps:{span:24},component:"RadioGroup",componentProps:{style:{width:"100%"}},value:"interval",formItemProps:{rules:[u()]},optionApi:async()=>{const e=s();return(await e.getDictObj(["vadmin_system_task_exec_strategy"])).vadmin_system_task_exec_strategy}},{field:"expression",label:"表达式",component:"Input",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:"interval 表达式，五位，分别为：秒 分 时 天 周，例如：10 * * * * 表示每隔 10 秒执行一次任务。"},ifshow:e=>"interval"===e.exec_strategy,formItemProps:{rules:[u()]}},{field:"expression",label:"表达式",component:"Input",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:"cron 表达式，六位或七位，分别表示秒、分钟、小时、天、月、星期几、年(可选)"},ifshow:e=>"cron"===e.exec_strategy,formItemProps:{rules:[u()]}},{field:"expression",label:"执行时间",component:"DatePicker",colProps:{span:24},componentProps:{style:{width:"100%"},type:"datetime",format:"YYYY-MM-DD HH:mm:ss",valueFormat:"YYYY-MM-DD HH:mm:ss"},ifshow:e=>"date"===e.exec_strategy,formItemProps:{rules:[u()]}},{field:"start_date",label:"开始时间",colProps:{span:12},component:"DatePicker",componentProps:{style:{width:"100%"},type:"datetime",format:"YYYY-MM-DD HH:mm:ss",valueFormat:"YYYY-MM-DD HH:mm:ss"},ifshow:e=>"date"!==e.exec_strategy},{field:"end_date",label:"结束时间",colProps:{span:12},component:"DatePicker",componentProps:{style:{width:"100%"},type:"datetime",format:"YYYY-MM-DD HH:mm:ss",valueFormat:"YYYY-MM-DD HH:mm:ss"},ifshow:e=>"date"!==e.exec_strategy},{field:"is_active",label:"任务状态",colProps:{span:8},component:"RadioGroup",componentProps:{style:{width:"100%"},options:[{label:"正常",value:!0},{label:"停用",value:!1}]},value:!0},{field:"",label:"",colProps:{span:16},component:"Text",value:"创建或更新任务完成后，如果任务状态与设置的不符，请尝试刷新数据或查看调度日志，任务状态可能会有延迟(几秒)。"},{field:"remark",label:"备注说明",component:"Input",colProps:{span:24},componentProps:{style:{width:"100%"},maxlength:"1000",showWordLimit:!0,type:"textarea",rows:"3"}}]),{formRegister:P,formMethods:y}=e(),{setValues:w,getFormData:h,getElFormExpose:Y}=y;return p((()=>d.currentRow),(e=>{e&&w(e)}),{deep:!0,immediate:!0}),c({submit:async()=>{const e=await Y();if(await(null==e?void 0:e.validate())){return await h()}}}),(e,o)=>(n(),m(i(t),{onRegister:i(P),schema:f},null,8,["onRegister","schema"]))}});export{c as _};
