{"version":3,"sources":["uni-app:///main.js","webpack:///D:/programming/ktianc/project/kinit-pro/kinit-uni/pages/mine/avatar/index.vue?91da","webpack:///D:/programming/ktianc/project/kinit-pro/kinit-uni/pages/mine/avatar/index.vue?5e1e","webpack:///D:/programming/ktianc/project/kinit-pro/kinit-uni/pages/mine/avatar/index.vue?e170","webpack:///D:/programming/ktianc/project/kinit-pro/kinit-uni/pages/mine/avatar/index.vue?40ea","uni-app:///pages/mine/avatar/index.vue","webpack:///D:/programming/ktianc/project/kinit-pro/kinit-uni/pages/mine/avatar/index.vue?aa15"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","PAGE_Y","T_PAGE_X","T_PAGE_Y","CUT_L","CUT_T","CUT_R","CUT_B","IMG_RATIO","IMG_REAL_W","IMG_REAL_H","DRAFG_MOVE_RATIO","PR","INIT_DRAG_POSITION","DRAW_IMAGE_W","data","imageSrc","isShowImg","cropperInitW","cropperInitH","cropperW","cropperH","cropperL","cropperT","transL","transT","scaleP","imageW","imageH","cutL","cutT","cutB","cutR","qualityWidth","innerAspectRadio","onReady","methods","setData","Object","that","getImage","uni","success","_this","loadImage","src","contentStartMove","PAGE_X","contentMoveing","contentTouchEnd","getImageInfo","title","ctx","x","y","width","height","destWidth","destHeight","quality","canvasId","store","icon","dragStart","dragMove","dragLength","dragLengthX","dragLengthY"],"mappings":"kJAAA,MAGA,aACA,YAFAA,EAAGC,kCAAoCC,EAGvCC,EAAWC,a,gFCLX,oIACIC,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,8BACZ,aAAAF,E,0CCvBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G,iCCRvB,yHAAusB,eAAG,G,2HCuH1sB,IAOA,EACAC,EAEAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAGAC,EACAC,EACAC,EApBA,WACA,WACA,SAGA,GADA,kBACA,uBACA,gBAeAC,GAZAC,aAYAD,GACAE,MACAC,gBAAA,EAEA,CAIAC,gBACA,OACAC,kCACAC,aAEAC,eACAC,eAEAC,WACAC,WAEAC,WACAC,WAEAC,SACAC,SAGAC,SACAC,SACAC,SAGAC,OACAC,OACAC,OACAC,YACAC,eACAC,qBAMAC,mBACA,kBAEAC,SACAC,oBACA,WACAC,oCACAC,2BAGAC,oBACA,WACAC,eACAC,oBACAC,WACA3B,8BAEA2B,kBAIAC,qBACA,WAEAH,gBACAI,eACAH,oBACAlC,IACA,MACAC,IACAC,QAEAD,MACAC,KAEA,cAGA,GAFAG,UAEA,MACA,iBACA,gBAEA,IACA,uBACA,IACA8B,WACAvB,WACAC,aAEAC,4BACAC,8BACAM,OACAC,OACAE,OACAD,OAEAJ,SACAC,SACAF,WACAO,eACAC,yBAEA,CACA,6BACA,IACA,qBACA,IACAS,WACAvB,aACAC,WAEAC,8BACAC,4BAEAM,OACAC,OACAE,OACAD,OAEAJ,SACAC,SACAF,WACAO,eACAC,qBAGAS,WACA1B,eAEAwB,oBAKAK,6BACAC,qBACA9C,sBAIA+C,2BACA,+BACA,2BAEA,IACA,6BAEA,8BAGA,IACA,6BAEA,8BAEA,cACAnB,iBACAC,iBACAE,iBACAD,mBAGAgB,qBACA9C,sBAGAgD,6BAGAC,wBACA,WACAT,eACAU,mBAEAV,gBACAI,eACAH,oBAEA,wCACAU,4BACAA,sBAEA,8CACA,0CACA,sBACA,sBACAX,wBACAY,IACAC,IACAC,QACAC,SACAC,YACAC,aACAC,WACAC,oBACAlB,oBACAD,iBACA,mEACAoB,2CACApB,aAAAU,aAAAW,iBACArB,8BASAsB,sBACA7D,qBACAC,qBACAC,YACAE,YACAC,YACAF,aAIA2D,qBACA,4BACA,SACA,SACA,SACA,UACA,YACAC,2BACA,cACA,cACAjC,WAEA,MACA,WACAiC,2BACA,aACA,8BACAA,+BACA,cACApC,WAEA,MACA,UACAoC,2BACA,aACA,8BACAA,+BACA,cACAnC,WAEA,MACA,aACAmC,2BACA,cACA,cACAlC,WAEA,MACA,kBACAmC,2BACAC,2BAEA,cACA,cAEA,cACApC,SACAC,WAEA,MACA,QACA,UAIA,c,6DChaA,yHAA4/B,eAAG,G","file":"pages/mine/avatar/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/mine/avatar/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=05deedaf&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/mine/avatar/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=05deedaf&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"container\">\r\n    <view class=\"page-body uni-content-info\">\r\n      <view class=\"cropper-content\">\r\n        <view\r\n          v-if=\"isShowImg\"\r\n          class=\"uni-corpper\"\r\n          :style=\"'width:' + cropperInitW + 'px;height:' + cropperInitH + 'px;background:#000'\"\r\n        >\r\n          <view\r\n            class=\"uni-corpper-content\"\r\n            :style=\"{\r\n              width: cropperW + 'px',\r\n              height: cropperH + 'px',\r\n              left: cropperL + 'px',\r\n              top: cropperT + 'px'\r\n            }\"\r\n          >\r\n            <image\r\n              :src=\"imageSrc\"\r\n              :style=\"'width:' + cropperW + 'px;height:' + cropperH + 'px'\"\r\n            ></image>\r\n            <view\r\n              class=\"uni-corpper-crop-box\"\r\n              :style=\"\r\n                'left:' + cutL + 'px;top:' + cutT + 'px;right:' + cutR + 'px;bottom:' + cutB + 'px'\r\n              \"\r\n              @touchstart.stop=\"contentStartMove\"\r\n              @touchmove.stop=\"contentMoveing\"\r\n              @touchend.stop=\"contentTouchEnd\"\r\n            >\r\n              <view class=\"uni-cropper-view-box\">\r\n                <view class=\"uni-cropper-dashed-h\"></view>\r\n                <view class=\"uni-cropper-dashed-v\"></view>\r\n                <view\r\n                  class=\"uni-cropper-line-t\"\r\n                  data-drag=\"top\"\r\n                  @touchstart.stop=\"dragStart\"\r\n                  @touchmove.stop=\"dragMove\"\r\n                ></view>\r\n                <view\r\n                  class=\"uni-cropper-line-r\"\r\n                  data-drag=\"right\"\r\n                  @touchstart.stop=\"dragStart\"\r\n                  @touchmove.stop=\"dragMove\"\r\n                ></view>\r\n                <view\r\n                  class=\"uni-cropper-line-b\"\r\n                  data-drag=\"bottom\"\r\n                  @touchstart.stop=\"dragStart\"\r\n                  @touchmove.stop=\"dragMove\"\r\n                ></view>\r\n                <view\r\n                  class=\"uni-cropper-line-l\"\r\n                  data-drag=\"left\"\r\n                  @touchstart.stop=\"dragStart\"\r\n                  @touchmove.stop=\"dragMove\"\r\n                ></view>\r\n                <view\r\n                  class=\"uni-cropper-point point-t\"\r\n                  data-drag=\"top\"\r\n                  @touchstart.stop=\"dragStart\"\r\n                  @touchmove.stop=\"dragMove\"\r\n                ></view>\r\n                <view class=\"uni-cropper-point point-tr\" data-drag=\"topTight\"></view>\r\n                <view\r\n                  class=\"uni-cropper-point point-r\"\r\n                  data-drag=\"right\"\r\n                  @touchstart.stop=\"dragStart\"\r\n                  @touchmove.stop=\"dragMove\"\r\n                ></view>\r\n                <view\r\n                  class=\"uni-cropper-point point-rb\"\r\n                  data-drag=\"rightBottom\"\r\n                  @touchstart.stop=\"dragStart\"\r\n                  @touchmove.stop=\"dragMove\"\r\n                ></view>\r\n                <view\r\n                  class=\"uni-cropper-point point-b\"\r\n                  data-drag=\"bottom\"\r\n                  @touchstart.stop=\"dragStart\"\r\n                  @touchmove.stop=\"dragMove\"\r\n                  @touchend.stop=\"dragEnd\"\r\n                ></view>\r\n                <view class=\"uni-cropper-point point-bl\" data-drag=\"bottomLeft\"></view>\r\n                <view\r\n                  class=\"uni-cropper-point point-l\"\r\n                  data-drag=\"left\"\r\n                  @touchstart.stop=\"dragStart\"\r\n                  @touchmove.stop=\"dragMove\"\r\n                ></view>\r\n                <view class=\"uni-cropper-point point-lt\" data-drag=\"leftTop\"></view>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      <view class=\"cropper-config\">\r\n        <button type=\"primary reverse\" style=\"margin-top: 30rpx\" @click=\"getImage\">\r\n          选择头像\r\n        </button>\r\n        <button type=\"warn\" style=\"margin-top: 30rpx\" @click=\"getImageInfo\"> 提交 </button>\r\n      </view>\r\n      <canvas\r\n        canvas-id=\"myCanvas\"\r\n        :style=\"{\r\n          width: imageW + 'px',\r\n          height: imageH + 'px',\r\n          position: 'absolute',\r\n          top: '-9999px',\r\n          border: '1px solid red',\r\n          left: '-9999px'\r\n        }\"\r\n      ></canvas>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport config from '@/config'\r\nimport store from '@/store'\r\nimport { postCurrentUserUploadAvatar } from '@/common/request/api/vadmin/auth/user.js'\r\n\r\nconst baseUrl = config.baseUrl\r\nlet sysInfo = uni.getSystemInfoSync()\r\nlet SCREEN_WIDTH = sysInfo.screenWidth\r\nlet PAGE_X, // 手按下的x位置\r\n  PAGE_Y, // 手按下y的位置\r\n  PR = sysInfo.pixelRatio, // dpi\r\n  T_PAGE_X, // 手移动的时候x的位置\r\n  T_PAGE_Y, // 手移动的时候Y的位置\r\n  CUT_L, // 初始化拖拽元素的left值\r\n  CUT_T, // 初始化拖拽元素的top值\r\n  CUT_R, // 初始化拖拽元素的\r\n  CUT_B, // 初始化拖拽元素的\r\n  CUT_W, // 初始化拖拽元素的宽度\r\n  CUT_H, //  初始化拖拽元素的高度\r\n  IMG_RATIO, // 图片比例\r\n  IMG_REAL_W, // 图片实际的宽度\r\n  IMG_REAL_H, // 图片实际的高度\r\n  DRAFG_MOVE_RATIO = 1, //移动时候的比例,\r\n  INIT_DRAG_POSITION = 100, // 初始化屏幕宽度和裁剪区域的宽度之差，用于设置初始化裁剪的宽度\r\n  DRAW_IMAGE_W = sysInfo.screenWidth // 设置生成的图片宽度\r\n\r\nexport default {\r\n  /**\r\n   * 页面的初始数据\r\n   */\r\n  data() {\r\n    return {\r\n      imageSrc: store.getters.avatar,\r\n      isShowImg: false,\r\n      // 初始化的宽高\r\n      cropperInitW: SCREEN_WIDTH,\r\n      cropperInitH: SCREEN_WIDTH,\r\n      // 动态的宽高\r\n      cropperW: SCREEN_WIDTH,\r\n      cropperH: SCREEN_WIDTH,\r\n      // 动态的left top值\r\n      cropperL: 0,\r\n      cropperT: 0,\r\n\r\n      transL: 0,\r\n      transT: 0,\r\n\r\n      // 图片缩放值\r\n      scaleP: 0,\r\n      imageW: 0,\r\n      imageH: 0,\r\n\r\n      // 裁剪框 宽高\r\n      cutL: 0,\r\n      cutT: 0,\r\n      cutB: SCREEN_WIDTH,\r\n      cutR: '100%',\r\n      qualityWidth: DRAW_IMAGE_W,\r\n      innerAspectRadio: DRAFG_MOVE_RATIO\r\n    }\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面初次渲染完成\r\n   */\r\n  onReady: function () {\r\n    this.loadImage()\r\n  },\r\n  methods: {\r\n    setData: function (obj) {\r\n      let that = this\r\n      Object.keys(obj).forEach(function (key) {\r\n        that.$set(that.$data, key, obj[key])\r\n      })\r\n    },\r\n    getImage: function () {\r\n      var _this = this\r\n      uni.chooseImage({\r\n        success: function (res) {\r\n          _this.setData({\r\n            imageSrc: res.tempFilePaths[0]\r\n          })\r\n          _this.loadImage()\r\n        }\r\n      })\r\n    },\r\n    loadImage: function () {\r\n      var _this = this\r\n\r\n      uni.getImageInfo({\r\n        src: _this.imageSrc,\r\n        success: function success(res) {\r\n          IMG_RATIO = 1 / 1\r\n          if (IMG_RATIO >= 1) {\r\n            IMG_REAL_W = SCREEN_WIDTH\r\n            IMG_REAL_H = SCREEN_WIDTH / IMG_RATIO\r\n          } else {\r\n            IMG_REAL_W = SCREEN_WIDTH * IMG_RATIO\r\n            IMG_REAL_H = SCREEN_WIDTH\r\n          }\r\n          let minRange = IMG_REAL_W > IMG_REAL_H ? IMG_REAL_W : IMG_REAL_H\r\n          INIT_DRAG_POSITION = minRange > INIT_DRAG_POSITION ? INIT_DRAG_POSITION : minRange\r\n          // 根据图片的宽高显示不同的效果   保证图片可以正常显示\r\n          if (IMG_RATIO >= 1) {\r\n            let cutT = Math.ceil(\r\n              (SCREEN_WIDTH / IMG_RATIO - (SCREEN_WIDTH / IMG_RATIO - INIT_DRAG_POSITION)) / 2\r\n            )\r\n            let cutB = cutT\r\n            let cutL = Math.ceil((SCREEN_WIDTH - SCREEN_WIDTH + INIT_DRAG_POSITION) / 2)\r\n            let cutR = cutL\r\n            _this.setData({\r\n              cropperW: SCREEN_WIDTH,\r\n              cropperH: SCREEN_WIDTH / IMG_RATIO,\r\n              // 初始化left right\r\n              cropperL: Math.ceil((SCREEN_WIDTH - SCREEN_WIDTH) / 2),\r\n              cropperT: Math.ceil((SCREEN_WIDTH - SCREEN_WIDTH / IMG_RATIO) / 2),\r\n              cutL: cutL,\r\n              cutT: cutT,\r\n              cutR: cutR,\r\n              cutB: cutB,\r\n              // 图片缩放值\r\n              imageW: IMG_REAL_W,\r\n              imageH: IMG_REAL_H,\r\n              scaleP: IMG_REAL_W / SCREEN_WIDTH,\r\n              qualityWidth: DRAW_IMAGE_W,\r\n              innerAspectRadio: IMG_RATIO\r\n            })\r\n          } else {\r\n            let cutL = Math.ceil((SCREEN_WIDTH * IMG_RATIO - SCREEN_WIDTH * IMG_RATIO) / 2)\r\n            let cutR = cutL\r\n            let cutT = Math.ceil((SCREEN_WIDTH - INIT_DRAG_POSITION) / 2)\r\n            let cutB = cutT\r\n            _this.setData({\r\n              cropperW: SCREEN_WIDTH * IMG_RATIO,\r\n              cropperH: SCREEN_WIDTH,\r\n              // 初始化left right\r\n              cropperL: Math.ceil((SCREEN_WIDTH - SCREEN_WIDTH * IMG_RATIO) / 2),\r\n              cropperT: Math.ceil((SCREEN_WIDTH - SCREEN_WIDTH) / 2),\r\n\r\n              cutL: cutL,\r\n              cutT: cutT,\r\n              cutR: cutR,\r\n              cutB: cutB,\r\n              // 图片缩放值\r\n              imageW: IMG_REAL_W,\r\n              imageH: IMG_REAL_H,\r\n              scaleP: IMG_REAL_W / SCREEN_WIDTH,\r\n              qualityWidth: DRAW_IMAGE_W,\r\n              innerAspectRadio: IMG_RATIO\r\n            })\r\n          }\r\n          _this.setData({\r\n            isShowImg: true\r\n          })\r\n          uni.hideLoading()\r\n        }\r\n      })\r\n    },\r\n    // 拖动时候触发的touchStart事件\r\n    contentStartMove(e) {\r\n      PAGE_X = e.touches[0].pageX\r\n      PAGE_Y = e.touches[0].pageY\r\n    },\r\n\r\n    // 拖动时候触发的touchMove事件\r\n    contentMoveing(e) {\r\n      var dragLengthX = (PAGE_X - e.touches[0].pageX) * DRAFG_MOVE_RATIO\r\n      var dragLengthY = (PAGE_Y - e.touches[0].pageY) * DRAFG_MOVE_RATIO\r\n      // 左移\r\n      if (dragLengthX > 0) {\r\n        if (this.cutL - dragLengthX < 0) dragLengthX = this.cutL\r\n      } else {\r\n        if (this.cutR + dragLengthX < 0) dragLengthX = -this.cutR\r\n      }\r\n\r\n      if (dragLengthY > 0) {\r\n        if (this.cutT - dragLengthY < 0) dragLengthY = this.cutT\r\n      } else {\r\n        if (this.cutB + dragLengthY < 0) dragLengthY = -this.cutB\r\n      }\r\n      this.setData({\r\n        cutL: this.cutL - dragLengthX,\r\n        cutT: this.cutT - dragLengthY,\r\n        cutR: this.cutR + dragLengthX,\r\n        cutB: this.cutB + dragLengthY\r\n      })\r\n\r\n      PAGE_X = e.touches[0].pageX\r\n      PAGE_Y = e.touches[0].pageY\r\n    },\r\n\r\n    contentTouchEnd() {},\r\n\r\n    // 获取图片\r\n    getImageInfo() {\r\n      var _this = this\r\n      uni.showLoading({\r\n        title: '图片生成中...'\r\n      })\r\n      uni.getImageInfo({\r\n        src: _this.imageSrc,\r\n        success: function (image) {\r\n          // 将图片写入画布\r\n          const ctx = uni.createCanvasContext('myCanvas')\r\n          ctx.drawImage(image.path, 0, 0, IMG_REAL_W, IMG_REAL_H)\r\n          ctx.draw(true, () => {\r\n            // 获取画布要裁剪的位置和宽度   均为百分比 * 画布中图片的宽度    保证了在微信小程序中裁剪的图片模糊  位置不对的问题 canvasT = (_this.cutT / _this.cropperH) * (_this.imageH / pixelRatio)\r\n            var canvasW = ((_this.cropperW - _this.cutL - _this.cutR) / _this.cropperW) * IMG_REAL_W\r\n            var canvasH = ((_this.cropperH - _this.cutT - _this.cutB) / _this.cropperH) * IMG_REAL_H\r\n            var canvasL = (_this.cutL / _this.cropperW) * IMG_REAL_W\r\n            var canvasT = (_this.cutT / _this.cropperH) * IMG_REAL_H\r\n            uni.canvasToTempFilePath({\r\n              x: canvasL,\r\n              y: canvasT,\r\n              width: canvasW,\r\n              height: canvasH,\r\n              destWidth: canvasW,\r\n              destHeight: canvasH,\r\n              quality: 0.5,\r\n              canvasId: 'myCanvas',\r\n              success: function (res) {\r\n                uni.hideLoading()\r\n                postCurrentUserUploadAvatar(res.tempFilePath).then((response) => {\r\n                  store.commit('auth/SET_AVATAR', response.data)\r\n                  uni.showToast({ title: '修改成功', icon: 'success' })\r\n                  uni.navigateBack()\r\n                })\r\n              }\r\n            })\r\n          })\r\n        }\r\n      })\r\n    },\r\n    // 设置大小的时候触发的touchStart事件\r\n    dragStart(e) {\r\n      T_PAGE_X = e.touches[0].pageX\r\n      T_PAGE_Y = e.touches[0].pageY\r\n      CUT_L = this.cutL\r\n      CUT_R = this.cutR\r\n      CUT_B = this.cutB\r\n      CUT_T = this.cutT\r\n    },\r\n\r\n    // 设置大小的时候触发的touchMove事件\r\n    dragMove(e) {\r\n      let dragType = e.target.dataset.drag\r\n      let dragLength = undefined\r\n      let dragLengthX = undefined\r\n      let dragLengthY = undefined\r\n      switch (dragType) {\r\n        case 'right':\r\n          dragLength = (T_PAGE_X - e.touches[0].pageX) * DRAFG_MOVE_RATIO\r\n          if (CUT_R + dragLength < 0) dragLength = -CUT_R\r\n          this.setData({\r\n            cutR: CUT_R + dragLength\r\n          })\r\n          break\r\n        case 'left':\r\n          dragLength = (T_PAGE_X - e.touches[0].pageX) * DRAFG_MOVE_RATIO\r\n          if (CUT_L - dragLength < 0) dragLength = CUT_L\r\n          if (CUT_L - dragLength > this.cropperW - this.cutR)\r\n            dragLength = CUT_L - (this.cropperW - this.cutR)\r\n          this.setData({\r\n            cutL: CUT_L - dragLength\r\n          })\r\n          break\r\n        case 'top':\r\n          dragLength = (T_PAGE_Y - e.touches[0].pageY) * DRAFG_MOVE_RATIO\r\n          if (CUT_T - dragLength < 0) dragLength = CUT_T\r\n          if (CUT_T - dragLength > this.cropperH - this.cutB)\r\n            dragLength = CUT_T - (this.cropperH - this.cutB)\r\n          this.setData({\r\n            cutT: CUT_T - dragLength\r\n          })\r\n          break\r\n        case 'bottom':\r\n          dragLength = (T_PAGE_Y - e.touches[0].pageY) * DRAFG_MOVE_RATIO\r\n          if (CUT_B + dragLength < 0) dragLength = -CUT_B\r\n          this.setData({\r\n            cutB: CUT_B + dragLength\r\n          })\r\n          break\r\n        case 'rightBottom':\r\n          dragLengthX = (T_PAGE_X - e.touches[0].pageX) * DRAFG_MOVE_RATIO\r\n          dragLengthY = (T_PAGE_Y - e.touches[0].pageY) * DRAFG_MOVE_RATIO\r\n\r\n          if (CUT_B + dragLengthY < 0) dragLengthY = -CUT_B\r\n          if (CUT_R + dragLengthX < 0) dragLengthX = -CUT_R\r\n\r\n          this.setData({\r\n            cutB: CUT_B + dragLengthY,\r\n            cutR: CUT_R + dragLengthX\r\n          })\r\n          break\r\n        default:\r\n          break\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n/* pages/uni-cropper/index.wxss */\r\n\r\n.uni-content-info {\r\n  /* position: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tdisplay: block;\r\n\t\talign-items: center;\r\n\t\tflex-direction: column; */\r\n}\r\n\r\n.cropper-config {\r\n  padding: 20rpx 40rpx;\r\n}\r\n\r\n.cropper-content {\r\n  min-height: 750rpx;\r\n  width: 100%;\r\n}\r\n\r\n.uni-corpper {\r\n  position: relative;\r\n  overflow: hidden;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n  -webkit-tap-highlight-color: transparent;\r\n  -webkit-touch-callout: none;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.uni-corpper-content {\r\n  position: relative;\r\n}\r\n\r\n.uni-corpper-content image {\r\n  display: block;\r\n  width: 100%;\r\n  min-width: 0 !important;\r\n  max-width: none !important;\r\n  height: 100%;\r\n  min-height: 0 !important;\r\n  max-height: none !important;\r\n  image-orientation: 0deg !important;\r\n  margin: 0 auto;\r\n}\r\n/* 移动图片效果 */\r\n\r\n.uni-cropper-drag-box {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  cursor: move;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  z-index: 1;\r\n}\r\n/* 内部的信息 */\r\n\r\n.uni-corpper-crop-box {\r\n  position: absolute;\r\n  background: rgba(255, 255, 255, 0.3);\r\n  z-index: 2;\r\n}\r\n\r\n.uni-corpper-crop-box .uni-cropper-view-box {\r\n  position: relative;\r\n  display: block;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: visible;\r\n  outline: 1rpx solid #69f;\r\n  outline-color: rgba(102, 153, 255, 0.75);\r\n}\r\n/* 横向虚线 */\r\n\r\n.uni-cropper-dashed-h {\r\n  position: absolute;\r\n  top: 33.33333333%;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 33.33333333%;\r\n  border-top: 1rpx dashed rgba(255, 255, 255, 0.5);\r\n  border-bottom: 1rpx dashed rgba(255, 255, 255, 0.5);\r\n}\r\n/* 纵向虚线 */\r\n\r\n.uni-cropper-dashed-v {\r\n  position: absolute;\r\n  left: 33.33333333%;\r\n  top: 0;\r\n  width: 33.33333333%;\r\n  height: 100%;\r\n  border-left: 1rpx dashed rgba(255, 255, 255, 0.5);\r\n  border-right: 1rpx dashed rgba(255, 255, 255, 0.5);\r\n}\r\n/* 四个方向的线  为了之后的拖动事件*/\r\n\r\n.uni-cropper-line-t {\r\n  position: absolute;\r\n  display: block;\r\n  width: 100%;\r\n  background-color: #69f;\r\n  top: 0;\r\n  left: 0;\r\n  height: 1rpx;\r\n  opacity: 0.1;\r\n  cursor: n-resize;\r\n}\r\n\r\n.uni-cropper-line-t::before {\r\n  content: '';\r\n  position: absolute;\r\n  top: 50%;\r\n  right: 0rpx;\r\n  width: 100%;\r\n  -webkit-transform: translate3d(0, -50%, 0);\r\n  transform: translate3d(0, -50%, 0);\r\n  bottom: 0;\r\n  height: 41rpx;\r\n  background: transparent;\r\n  z-index: 11;\r\n}\r\n\r\n.uni-cropper-line-r {\r\n  position: absolute;\r\n  display: block;\r\n  background-color: #69f;\r\n  top: 0;\r\n  right: 0rpx;\r\n  width: 1rpx;\r\n  opacity: 0.1;\r\n  height: 100%;\r\n  cursor: e-resize;\r\n}\r\n\r\n.uni-cropper-line-r::before {\r\n  content: '';\r\n  position: absolute;\r\n  top: 0;\r\n  left: 50%;\r\n  width: 41rpx;\r\n  -webkit-transform: translate3d(-50%, 0, 0);\r\n  transform: translate3d(-50%, 0, 0);\r\n  bottom: 0;\r\n  height: 100%;\r\n  background: transparent;\r\n  z-index: 11;\r\n}\r\n\r\n.uni-cropper-line-b {\r\n  position: absolute;\r\n  display: block;\r\n  width: 100%;\r\n  background-color: #69f;\r\n  bottom: 0;\r\n  left: 0;\r\n  height: 1rpx;\r\n  opacity: 0.1;\r\n  cursor: s-resize;\r\n}\r\n\r\n.uni-cropper-line-b::before {\r\n  content: '';\r\n  position: absolute;\r\n  top: 50%;\r\n  right: 0rpx;\r\n  width: 100%;\r\n  -webkit-transform: translate3d(0, -50%, 0);\r\n  transform: translate3d(0, -50%, 0);\r\n  bottom: 0;\r\n  height: 41rpx;\r\n  background: transparent;\r\n  z-index: 11;\r\n}\r\n\r\n.uni-cropper-line-l {\r\n  position: absolute;\r\n  display: block;\r\n  background-color: #69f;\r\n  top: 0;\r\n  left: 0;\r\n  width: 1rpx;\r\n  opacity: 0.1;\r\n  height: 100%;\r\n  cursor: w-resize;\r\n}\r\n\r\n.uni-cropper-line-l::before {\r\n  content: '';\r\n  position: absolute;\r\n  top: 0;\r\n  left: 50%;\r\n  width: 41rpx;\r\n  -webkit-transform: translate3d(-50%, 0, 0);\r\n  transform: translate3d(-50%, 0, 0);\r\n  bottom: 0;\r\n  height: 100%;\r\n  background: transparent;\r\n  z-index: 11;\r\n}\r\n\r\n.uni-cropper-point {\r\n  width: 5rpx;\r\n  height: 5rpx;\r\n  background-color: #69f;\r\n  opacity: 0.75;\r\n  position: absolute;\r\n  z-index: 3;\r\n}\r\n\r\n.point-t {\r\n  top: -3rpx;\r\n  left: 50%;\r\n  margin-left: -3rpx;\r\n  cursor: n-resize;\r\n}\r\n\r\n.point-tr {\r\n  top: -3rpx;\r\n  left: 100%;\r\n  margin-left: -3rpx;\r\n  cursor: n-resize;\r\n}\r\n\r\n.point-r {\r\n  top: 50%;\r\n  left: 100%;\r\n  margin-left: -3rpx;\r\n  margin-top: -3rpx;\r\n  cursor: n-resize;\r\n}\r\n\r\n.point-rb {\r\n  left: 100%;\r\n  top: 100%;\r\n  -webkit-transform: translate3d(-50%, -50%, 0);\r\n  transform: translate3d(-50%, -50%, 0);\r\n  cursor: n-resize;\r\n  width: 36rpx;\r\n  height: 36rpx;\r\n  background-color: #69f;\r\n  position: absolute;\r\n  z-index: 1112;\r\n  opacity: 1;\r\n}\r\n\r\n.point-b {\r\n  left: 50%;\r\n  top: 100%;\r\n  margin-left: -3rpx;\r\n  margin-top: -3rpx;\r\n  cursor: n-resize;\r\n}\r\n\r\n.point-bl {\r\n  left: 0%;\r\n  top: 100%;\r\n  margin-left: -3rpx;\r\n  margin-top: -3rpx;\r\n  cursor: n-resize;\r\n}\r\n\r\n.point-l {\r\n  left: 0%;\r\n  top: 50%;\r\n  margin-left: -3rpx;\r\n  margin-top: -3rpx;\r\n  cursor: n-resize;\r\n}\r\n\r\n.point-lt {\r\n  left: 0%;\r\n  top: 0%;\r\n  margin-left: -3rpx;\r\n  margin-top: -3rpx;\r\n  cursor: n-resize;\r\n}\r\n/* 裁剪框预览内容 */\r\n\r\n.uni-cropper-viewer {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n}\r\n\r\n.uni-cropper-viewer image {\r\n  position: absolute;\r\n  z-index: 2;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../install/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}